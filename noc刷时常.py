import random
import time
from threading import Thread

import requests


def getHeader():
    headers = {'Host': 'miaomiao.scmttec.com',
               'Connection': 'keep-alive',
               'Accept': 'application/json, text/plain, */*',
               'Cookie': '_xxhm_=%7B%22id%22%3A11636559%2C%22mobile%22%3A%2218483228857%22%2C%22nickName%22%3A%22%E5%B0%8F%E7%AC%A6%22%2C%22headerImg%22%3A%22https%3A%2F%2Fthirdwx.qlogo.cn%2Fmmopen%2Fvi_32%2FDYAIOgq83eqE2ib7iaGACNGvIjCCxicWj8oVZfryNoyDBrIQ5YBfsh9ibOtZpIIlPpicEcD5w4xrFcZCP5R7koB6dpw%2F132%22%2C%22regionCode%22%3A%220%22%2C%22name%22%3A%22%22%2C%22sex%22%3A1%2C%22hasPassword%22%3Afalse%7D; _xzkj_=wxapptoken:10:e1b821f0d9bb4955b1da08abe1e76fde_3a4e8a758667597270f1e1dbad4716bc; 367f=69f271784c21318721; tgw_l7_route=6e0a47ce8062c68ea282b9bbb140678e',
               'User-Agent': 'Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/53.0.2785.143 Safari/537.36 MicroMessenger/7.0.9.501 NetType/WIFI MiniProgramEnv/Windows WindowsWechat',
               'X-Requested-With': 'XMLHttpRequest',
               'content-type': 'application/json',
               'tk': 'wxapptoken:10:e1b821f0d9bb4955b1da08abe1e76fde_3a4e8a758667597270f1e1dbad4716bc',
               'Referer': 'https://servicewechat.com/wxff8cad2e9bf18719/24/page-frame.html',
               'Accept-Encoding': 'gzip, deflate, br'}
    return headers


def getRequests(url, payload, headers):
    response = requests.get(url, json=payload, headers=headers, params=payload, allow_redirects=True)
    return response

def postRequests(url, payload, headers):
    response = requests.post(url, json=payload, headers=headers, params=payload)
    return response


def getList(regionCode):
    url = "https://miaomiao.scmttec.com/seckill/seckill/list.do"
    payload = {
        'offset': 0,
        'limit': 10,
        'regionCode': regionCode
    }
    headers = getHeader()
    jresponse = getRequests(url=url, payload=payload, headers=headers)
    return jresponse


def getChildRegions(parentCode):
    url = 'https://miaomiao.scmttec.com/base/region/childRegions.do'
    if parentCode == -1:
        payload = {}
    else:
        payload = {
            'parentCode': parentCode,
        }
    headers = getHeader()
    jresponse = getRequests(url=url, payload=payload, headers=headers)
    return jresponse

# http://ccp.noc.net.cn/Course/IncreaseDuration
def duration(id):
    url = 'http://ccp.noc.net.cn/Course/IncreaseDuration'
    headers = {'Accept': 'application/json, text/javascript, */*; q=0.01',
               'Accept-Encoding': 'gzip, deflate',
               'Accept-Language': 'zh-CN,zh;q=0.9',
               'Connection': 'keep-alive',
               'Content-Length': '17',
               'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',
               'Cookie': 'CcpVerifyCodeSendTimeFotgot=638112698705522879; .ASPXAUTH=411A6133B04DC27CF28187B1060F3169199236445D7A596980F455A69202C62C4534400AA057A80E1DF2FA0D25A32BBDEEA6894B361C0BF58576B9159533EF3713C0E2F32EB5048D6C3D30A38A084499A169B869531BAAF113EF3AF8676CE4615C2CAA0E5A48CAD2C5EBF4B1F6402690EB12A79AA032CB4EAD3DEFE3E791E0E40DE92A2A7D10120366971E68592EF245B3BB7FAAF6759109528B43F90ECF113BFDE3DEED62683083B92117FD5A89C1AE82C092D12DBFE6E858508CAA7A8FCFB175E855F4D993BF6DCEE5DDF6A4F2263BC5F902E0DC5BAC3BEFCAD3B447518E8A6FC4D603A681D66B0841C4A67D577850926509FD599411FAC937BC2D00ED6F13EE6CF2B9C891A031153D4D0223D346C8CE79A0C929877263D54D3376F4FDA1F71F098BA81DAC582D5D9E35962254022E3C13371154D7F882D91C8682E58E374EA2E770E78F168948F8B5FD0578243C3537F8A0EFD139F22F446986390F8F2F5728EB72163A2680EADDE52C6B84C0155724C861E99E962E4E153DC04D51F01E5947DFC06C66AEE32C6EB7D6DBE02556CB41B846412C43C26197BA1CFA9C4BE0BA44728F5E811D18FCBF7BCF5D91C3202B9EC5163E85095489B1DA9FE5E9B40D5FF80CCB6AB0917EA461914209D7A40C5D6EAC4AE85E2D042F80819E933A1FC1ABF6749CA9E18842C5DC11FEB2324512E90D47874AEF7773483DA813026AE4DE7B8724D097908E1C0452B3E8217798631017A8760AB4C59178E62D621403FF3F4D4B5750F79DA154D1BD30FEFB3824D1EFB889CDCFF312AD2D165420A3238795FA7ACC553573E4843098D907F6C28E4C32726F562046AD672F57A9EF743DCC22AA8F4D05BAF31F947DCC67EF25F52F4F263AED2C7B5F58794ACFB3513756B0E1D303129C99DC71F0534E8FBE33E853D83412159251835D07FF0C593087D616CB2D3A1E8FFD0CC30F4B64A0423E081684A2761CC309F5E39A148F195ECB7E78A5B9FC9EDCBE3DF7A0620C57AA6677DCD46AA28BDB2C799B04A4D3D2217D2B12DB3EBFD4C6BEAE8291EC1B53C3D9645E1EC0F93996786D571DC84F55FFB5D21DBE5279050E8479C332C471BC8B321FB45C37734763DE80E4675AEFA023C7AC6D2F991DB2CD5F5C27D7089C991A1378D82CCBFB1534452F6508D673A0F6E2B4E460D7496889EACB4C819275721E1AA0C76855FB8D3AABD7BF5E37DB09711A93513F345F74D22997775DDDC34A8CFEC788407C2348381AC08B0E0B6B4472108903C8A5C22051A09349709FF77609CA893066DC705B1DB9297F491F41AD7FC1EE3C737361CD7C95C8A10583FD433EFDC0A90DF60D84518DFB96D997F6158B9C1EE40F8604109BAEDC783D38F044C7A0885112129B6AD7D87DA41873F430456A284D7AE71C468519A3AFE59A62171A9B62CACC0E54AFB7E45F9B578ED829090C45C42C4F',
               'Host': 'ccp.noc.net.cn',
               'Origin': 'http://ccp.noc.net.cn',
               'Referer': 'http://ccp.noc.net.cn/Course/Lesson?cid=5&lid=13',
               'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36',
               'X-Requested-With': 'XMLHttpRequest'
               }
    payload = { 'id': id, 'duration': 10}
    re = getRequests(url=url, payload=payload, headers=headers)
    print(re)


def lessoned():
    url = 'http://ccp.noc.net.cn/Course/Lessoned'
    headers = {'Accept': 'application/json, text/javascript, */*; q=0.01',
               'Accept-Encoding': 'gzip, deflate',
               'Accept-Language': 'zh-CN,zh;q=0.9',
               'Connection': 'keep-alive',
               'Content-Length': '17',
               'Content-Type': 'application/x-www-encodeform-urld; charset=UTF-8',
               'Cookie': 'CcpVerifyCodeSendTimeFotgot=638112698705522879; .ASPXAUTH=411A6133B04DC27CF28187B1060F3169199236445D7A596980F455A69202C62C4534400AA057A80E1DF2FA0D25A32BBDEEA6894B361C0BF58576B9159533EF3713C0E2F32EB5048D6C3D30A38A084499A169B869531BAAF113EF3AF8676CE4615C2CAA0E5A48CAD2C5EBF4B1F6402690EB12A79AA032CB4EAD3DEFE3E791E0E40DE92A2A7D10120366971E68592EF245B3BB7FAAF6759109528B43F90ECF113BFDE3DEED62683083B92117FD5A89C1AE82C092D12DBFE6E858508CAA7A8FCFB175E855F4D993BF6DCEE5DDF6A4F2263BC5F902E0DC5BAC3BEFCAD3B447518E8A6FC4D603A681D66B0841C4A67D577850926509FD599411FAC937BC2D00ED6F13EE6CF2B9C891A031153D4D0223D346C8CE79A0C929877263D54D3376F4FDA1F71F098BA81DAC582D5D9E35962254022E3C13371154D7F882D91C8682E58E374EA2E770E78F168948F8B5FD0578243C3537F8A0EFD139F22F446986390F8F2F5728EB72163A2680EADDE52C6B84C0155724C861E99E962E4E153DC04D51F01E5947DFC06C66AEE32C6EB7D6DBE02556CB41B846412C43C26197BA1CFA9C4BE0BA44728F5E811D18FCBF7BCF5D91C3202B9EC5163E85095489B1DA9FE5E9B40D5FF80CCB6AB0917EA461914209D7A40C5D6EAC4AE85E2D042F80819E933A1FC1ABF6749CA9E18842C5DC11FEB2324512E90D47874AEF7773483DA813026AE4DE7B8724D097908E1C0452B3E8217798631017A8760AB4C59178E62D621403FF3F4D4B5750F79DA154D1BD30FEFB3824D1EFB889CDCFF312AD2D165420A3238795FA7ACC553573E4843098D907F6C28E4C32726F562046AD672F57A9EF743DCC22AA8F4D05BAF31F947DCC67EF25F52F4F263AED2C7B5F58794ACFB3513756B0E1D303129C99DC71F0534E8FBE33E853D83412159251835D07FF0C593087D616CB2D3A1E8FFD0CC30F4B64A0423E081684A2761CC309F5E39A148F195ECB7E78A5B9FC9EDCBE3DF7A0620C57AA6677DCD46AA28BDB2C799B04A4D3D2217D2B12DB3EBFD4C6BEAE8291EC1B53C3D9645E1EC0F93996786D571DC84F55FFB5D21DBE5279050E8479C332C471BC8B321FB45C37734763DE80E4675AEFA023C7AC6D2F991DB2CD5F5C27D7089C991A1378D82CCBFB1534452F6508D673A0F6E2B4E460D7496889EACB4C819275721E1AA0C76855FB8D3AABD7BF5E37DB09711A93513F345F74D22997775DDDC34A8CFEC788407C2348381AC08B0E0B6B4472108903C8A5C22051A09349709FF77609CA893066DC705B1DB9297F491F41AD7FC1EE3C737361CD7C95C8A10583FD433EFDC0A90DF60D84518DFB96D997F6158B9C1EE40F8604109BAEDC783D38F044C7A0885112129B6AD7D87DA41873F430456A284D7AE71C468519A3AFE59A62171A9B62CACC0E54AFB7E45F9B578ED829090C45C42C4F',
               'Host': 'ccp.noc.net.cn',
               'Origin': 'http://ccp.noc.net.cn',
               'Referer': 'http://ccp.noc.net.cn/Course/Lesson?cid=5&lid=13',
               'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36',
               'X-Requested-With': 'XMLHttpRequest'
               }
    payload = { 'lesson': 1}
    re = getRequests(url=url, payload=payload, headers=headers)
    print(re)

def mylen(id,len):
    for i in range(1,len):
        try:
            time.sleep(random.randint(2,3))
            lessoned()
            duration(id)
        except BaseException:
            print('aa')




if __name__ == "__main__":
    # 启用线程
    # 44 和 50 分别代表课程的ID这里就是44-50
    t1 = Thread(target=mylen, args=(44,50))
    time.sleep(random.randint(2,3))
    t1.start()
